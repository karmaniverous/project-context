# Refactor: ensure patch workspace exists before archiving

When: 2025-08-21T13:15:00Z
Why: On a fresh repo, `stan run -a` failed with ENOENT on `<stanPath>/patch` because the diff archiver always includes the patch workspace but no code created it yet.
What changed:

- src/stan/fs.ts: ensureOutAndDiff() now creates `<stanPath>/patch`.
- src/stan/config.ts: ensureOutputDir() also creates `<stanPath>/patch`.
  Tests/Lint:
- Behavior: run operations now create all working directories as needed; no ENOENT on first run.
- Lint/Typecheck: unchanged.
  Next:
- None.
