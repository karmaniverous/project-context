diff a/src/cli/stan/runner.ts b/src/cli/stan/runner.ts	(rejected hunks)
@@ -40,6 +40,21 @@ export const registerRun = (cli: Command): Command => {
   cmd.addOption(combineOpt);
 
+  // Track raw presence of selection flags to detect conflicts reliably.
+  let sawNoScriptsFlag = false;
+  let sawScriptsFlag = false;
+  let sawExceptFlag = false;
+  cmd.on('option:no-scripts', () => {
+    sawNoScriptsFlag = true;
+  });
+  cmd.on('option:scripts', () => {
+    // Only fires for -s/--scripts, not -S.
+    sawScriptsFlag = true;
+  });
+  cmd.on('option:except-scripts', () => {
+    sawExceptFlag = true;
+  });
+
   cmd.addHelpText('after', () => renderAvailableScriptsHelp(process.cwd()));
 
   cmd.action(async (options: Record<string, unknown>) => {
@@ -99,11 +114,11 @@ export const registerRun = (cli: Command): Command => {
     const planOnly = Boolean((opts as { plan?: unknown }).plan);
 
     // Manual conflict handling:
-    // -S with -s or -x
-    if (noScripts && (scriptsProvided || exceptProvided)) {
+    // -S with -s or -x (detect by raw presence to handle last-wins semantics)
+    if (sawNoScriptsFlag && (sawScriptsFlag || sawExceptFlag)) {
       throw new CommanderError(
         1,
         'commander.conflictingOption',
         "error: option '-S, --no-scripts' cannot be used with option '-s, --scripts' or '-x, --except-scripts'",
       );
     }
